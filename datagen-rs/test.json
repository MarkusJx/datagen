{
  "$schema": "./schema.json",
  "options": {
    "plugins": {
      "openaddresses_plugin": {
        "files": "./datagen-rs/us_ak_haines.geojson",
        "backend": {
          "type": "sqlite",
          "databaseName": "addresses.db"
        }
      }
    },
    "serializeRefs": true,
    "serializer": {
      "type": "json",
      "pretty": true
    }
  },
  "type": "array",
  "length": {
    "value": 2
  },
  "items": {
    "type": "object",
    "properties": {
      "id": {
        "type": "string",
        "generator": {
          "type": "uuid"
        }
      },
      "idCopy": "ref:./id",
      "firstName": {
        "type": "string",
        "generator": {
          "type": "firstName"
        }
      },
      "lastName": {
        "type": "string",
        "generator": {
          "type": "lastName"
        }
      },
      "fullName": {
        "type": "string",
        "generator": {
          "type": "format",
          "format": "{{firstName}} {{lastName}}",
          "args": {
            "firstName": "ref:./firstName",
            "lastName": "ref:./lastName"
          }
        }
      },
      "userName": {
        "type": "string",
        "generator": {
          "type": "username"
        }
      },
      "email": {
        "type": "string",
        "generator": {
          "type": "email"
        }
      },
      "age": {
        "type": "integer",
        "min": 0,
        "max": 100
      },
      "addresses": {
        "type": "array",
        "length": {
          "value": 1
        },
        "items": {
          "type": "object",
          "properties": {
            "street": {
              "type": "string",
              "generator": {
                "type": "street"
              }
            },
            "city": {
              "type": "string",
              "generator": {
                "type": "city"
              }
            },
            "state": {
              "type": "string",
              "generator": {
                "type": "state"
              }
            },
            "zip": {
              "type": "string",
              "generator": {
                "type": "zipCode"
              }
            },
            "country": {
              "type": "string",
              "generator": {
                "type": "country"
              }
            },
            "latitude": {
              "type": "string",
              "generator": {
                "type": "latitude"
              }
            },
            "latitudeAsString": {
              "type": "string",
              "generator": {
                "type": "format",
                "format": "{{latitude}}",
                "args": {
                  "latitude": {
                    "generator": {
                      "type": "latitude"
                    }
                  }
                }
              }
            },
            "countryCode": {
              "type": "string",
              "generator": {
                "type": "countryCode"
              }
            },
            "fullAddress": {
              "type": "string",
              "generator": {
                "type": "format",
                "format": "{{street}}, {{city}}, {{state}} {{zip}}, {{country}}",
                "args": {
                  "street": "ref:./street",
                  "city": "ref:./city",
                  "state": "ref:./state",
                  "zip": "ref:./zip",
                  "country": "ref:./country"
                },
                "serializeNonStrings": false
              }
            }
          }
        }
      },
      "addressCopy": {
        "type": "reference",
        "reference": "ref:./addresses",
        "keepAll": true
      },
      "relatedPersons": {
        "type": "array",
        "length": {
          "value": 1
        },
        "items": {
          "type": "object",
          "properties": {
            "id": {
              "type": "string",
              "generator": {
                "type": "uuid"
              }
            },
            "relationshipType": {
              "type": "anyOf",
              "values": [
                "parent",
                "child",
                "sibling",
                "spouse",
                "friend"
              ]
            },
            "relatedParty": {
              "type": "reference",
              "reference": "id",
              "except": [
                "ref:../../relatedPersons.relatedParty",
                "ref:../../id"
              ]
            }
          },
          "transform": [
            {
              "type": "filter",
              "field": "ref:./relatedParty",
              "operator": "notEquals",
              "other": null
            }
          ]
        },
        "transform": [
          {
            "type": "filterNonNull"
          }
        ]
      },
      "openaddr": {
        "type": "flatten",
        "values": [
          {
            "type": "object",
            "properties": {
              "id": {
                "type": "string",
                "generator": {
                  "type": "uuid"
                }
              }
            }
          },
          {
            "type": "generator",
            "pluginName": "openaddresses_plugin",
            "args": {
              "street": "street",
              "houseNumber": "number",
              "city": "city",
              "coordinates": {
                "latitude": "latitude",
                "longitude": "longitude"
              }
            }
          }
        ],
        "transform": [
          {
            "type": "toString",
            "subType": "format",
            "format": "{{street}} {{houseNumber}}, {{city}}"
          },
          {
            "type": "toUpperCase"
          }
        ]
      }
    }
  }
}